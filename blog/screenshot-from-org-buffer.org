#+TITLE:       Take a Screenshot and Add a link to it in Org
#+AUTHOR:      Jinha Kim
#+EMAIL:       jinha.kim@oracle.com
#+DATE:        2016-11-09 Wed
#+URI:         /blog/%y/%m/%d/get-screenshot-and-store-it-in-org
#+TAGS:        org-mode, screenshot
#+LANGUAGE:    en
#+OPTIONS:     H:3 num:nil toc:nil \n:nil ::t |:t ^:nil -:nil f:t *:t <:t

Sometimes I want to take and store a screenshot, then add link to the screenshot in org buffer. I found a awesome solution from [[http://stackoverflow.com/questions/17435995/paste-an-image-on-clipboard-to-emacs-org-mode-file-without-saving-it][stackoverflow]] that works under macOS and Linux (X11). I've slightly changed the code to let it accept a =<basename>= from the mini-buffer prompt. Paste the following code in a file of your =load-path= and load it.

#+BEGIN_SRC emacs-lisp
(if (window-system)
    (progn
      (defun goldbar80/org-screenshot (basename)
        "Take a screenshot into a time stamped unique-named file in the
same directory as the org-buffer and insert a link to this file."
        (interactive
         (let ((default_name (format-time-string "%Y%m%d_%H%M%S")))
           (list
            (read-string (format "file name prefix (%s)): " default_name) nil nil default_name))))
        (message basename)
        (org-display-inline-images)
        (setq filename
              (concat
               (file-name-base (buffer-file-name))
               "/"
               basename
               ".png"))
        (unless (file-exists-p (file-name-directory filename))
          (make-directory (file-name-directory filename)))
                                        ; take screenshot
        (if (eq system-type 'darwin)
            (call-process "screencapture" nil nil nil "-i" filename))
        (if (eq system-type 'gnu/linux)
            (call-process "import" nil nil nil filename))
                                        ; insert into file if correctly taken
        (if (file-exists-p filename)
            (insert (concat "[[file:" filename "]]"))))
      ))
#+END_SRC

Once you invoke  =M-x goldbar80/org-screenshot=, you are prompted to enter a =<basename>=. The default value is the timestamp when the function is called. The original code adds a random string after the timestamp, but I dropped it as I assume I wouldn't call the function multiple times in one second :) Then, capture your designated area using your pointing device. Finally, the screenshot will be stored in =<org buffer file basename>/<basename>.png= and a link to it will be inserted to your org buffer.
